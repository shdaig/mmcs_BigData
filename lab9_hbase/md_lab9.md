Шепелев Д.

### **Задание 9 / Hbase**

Все задание выполнялись в Python с помощью библиотеки `happybase`

#### **0. Заполение БД**

Шаблон создания таблиц:

```python
connection.create_table(
    'courses',
    {
        'info': dict(),
    }
)

```

Шаблон для создания пользователей:

```python
users_table.put(b'U001', 
                {
                    b'info:name': b'Tilda Swinton', 
                    b'info:birth_date': b'1990-10-05',            
                    b'info:corporate_client': b'False', 
                    b'courses:C001': b'',
                    b'courses:C002': b'',
                    b'courses:C003': b''
                }
               )

```

Шаблон для создания курсов:

```python
courses_table.put(b'C001', 
                 {
                    b'info:name': b'...', 
                    b'info:duration': b'4', 
                    b'info:start_date': b'2023-03-20T00:00:00.000Z', 
                    b'info:end_date': b'2023-03-20T00:00:00.000Z', 
                    b'info:description': b'Course 1 description', 
                    b'info:lecturer': b'..., 
                    b'info:price': b'900'
                 }
)

```

#### **1. Вывести средний возраст пользователей по каждому курсу.**



#### **2. Вывести курсы в которых физических клиентов, больше чем корпоративных клиент и их процентное соотношение.**



#### **3. Вывести курсы, которые уже завершились.**



#### **4. Вывести курсы, которые еще предстоят и количество записавшихся на них пользователей.**

#### **5. Вывести полученную прибыль от курсов, которые завершились и уже проходят.**